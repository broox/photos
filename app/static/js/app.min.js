function getBrowserWidth(){return Math.max(document.body.scrollWidth,document.documentElement.scrollWidth,document.body.offsetWidth,document.documentElement.offsetWidth,document.documentElement.clientWidth)}function getBrowserHeight(){return Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.documentElement.clientHeight)}function isLargeViewport(){return getBrowserWidth()>500}function serializeForPhotoSwipe(t){const e=isLargeViewport()?t.images.medium:t.images.small;let o=t.images.medium;return t.images.large&&(o=t.images.large),{id:t.id,src:o,w:t.width,h:t.height,msrc:e,title:t.description,thumbnail:e}}const photosMixin={data:{photos:[],offset:0,limit:20,photoRowHeight:200,searchTerm:null},created(){isLargeViewport()&&(this.limit=40,this.photoRowHeight=300)},methods:{loadPhotos(){this.getRecentPhotos().then(()=>{this.renderGallery(),this.setupSlideShow()})},getRecentPhotos(){this.message="Loading...";const t={limit:this.limit,offset:this.offset};this.searchTerm&&(t.search=this.searchTerm);const e=encodeURIComponent,o=Object.keys(t).map(o=>e(o)+"="+e(t[o])).join("&");return fetch("/api/v1/photos?"+o).then(t=>t.json()).then(t=>{const e=t.data;this.totalPhotoCount=t.meta.count,this.addPhotosToGallery(e),this.message=null}).catch(t=>{this.message="Error loading photos",console.error("Error fetching photos")})},getMorePhotos(){this.offset=this.offset+this.limit,this.offset>=this.totalPhotoCount||this.loadPhotos()},renderGallery(){new flexImages({selector:".flex-images",rowHeight:this.photoRowHeight}),window.addEventListener("scroll",this.infiniteScroll)},addPhotosToGallery(t){var e=t.map(serializeForPhotoSwipe);this.photos.push(...e)},searchPhotos(){this.photos=[],this.offset=0,this.totalPhotoCount=0,this.loadPhotos()},setupSlideShow(){const t=document.querySelectorAll(".item");for(let e=t.length;e--;)t[e].onclick=this.openSlideShow},openSlideShow(t){t.preventDefault();const e=document.querySelectorAll(".pswp")[0],o={index:parseInt(t.currentTarget.dataset.index,10),getThumbBoundsFn:function(t){var e=document.querySelectorAll(".item img")[t],o=window.pageYOffset||document.documentElement.scrollTop,i=e.getBoundingClientRect();return{x:i.left,y:i.top+o,w:i.width}},shareButtons:[{id:"download",label:"Download image",url:"{{raw_image_url}}",download:!0}]};isNaN(o.index)||new PhotoSwipe(e,PhotoSwipeUI_Default,this.photos,o).init()},infiniteScroll(){const t=document.documentElement.offsetHeight;document.documentElement.scrollTop+window.innerHeight+10*this.photoRowHeight>=t&&(this.getMorePhotos(),window.removeEventListener("scroll",this.infiniteScroll))}}},app=new Vue({el:"#app",data:{message:null},mixins:[photosMixin],beforeMount(){this.loadPhotos()}}),header=document.getElementById("pageHeader"),sticky=header.offsetTop;window.onscroll=()=>{window.pageYOffset>sticky?header.classList.add("sticky"):header.classList.remove("sticky")};